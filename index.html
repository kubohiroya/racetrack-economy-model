<!DOCTYPE html>
<html lang="en">
<head>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">
    <title>The Racetrack Economy</title>
    <meta charset="UTF-8"/>
    <link href="./src/style.css" rel="stylesheet">
</head>
<body>

<div id="root">

    <h1 id="title">
        <div id="raceTrackTitle">
            <div class="infoDialogOpenButton">
                <div class="icon" id="raceTrackIcon" style="width:32px; height: 32px"></div>
            </div>
            The Racetrack Economy Model
        </div>
        <div id="graphTitle">
            <div class="infoDialogOpenButton">
                <div class="icon" id="graphIcon" style="width:32px; height: 32px"></div>
            </div>
            The Graph Structured Economy Model
        </div>
    </h1>

    <fast-dialog aria-label="modal dialog" hidden id="infoDialog" modal="true">
        <div class="dialog">
            <div id="raceTrackDialog">
                <h2 class="dialogTitle">The Racetrack Economy Model</h2>
                <div class="dialogContent">
                    <p>Paul Krugman, the 2008 winner of the Nobel Prize in Economics, conducted a simulation using a
                        spatial
                        economics model called the "Racetrack Economy" model.
                        This model hypothesizes several locations (in Krugman's case, 12 cities) arranged at equal
                        intervals
                        in a circular fashion, like the numbers on a clock face.
                        The economy includes farmers, who live in the locations and do not move, and factory workers,
                        who
                        move between the locations in search of higher wages and lower prices.
                    </p>
                    <p>
                        Initially, the populations of the locations are only slightly different (a uniformly equal
                        location
                        size causes equilibrium, which prevents the simulation from working).
                    </p>
                    <p>
                        Using these basic conditions, Krugman modified transportation cost (T) and the degree of love of
                        variety for industrial products (σ) in order to analyze changes in the numbers and
                        locations of agglomerations.
                    </p>
                    <p>
                        Variables "Κ", "π", "τ" and "σ" can be changed while the simulation is in progress.
                        This allows the observation of agglomeration formation, agglomeration dispersal, and changes in
                        the
                        numbers and locations of agglomerations according to various parameters.
                    </p>
                </div>
            </div>
            <div id="graphDialog">
                <h2 class="dialogTitle">The Graph Structured Economy Model</h2>
                <div class="dialogContent">
                    <p>
                        The Graph Structured Economy Model is a simulation model that extends the Racetrack Economy
                        Model
                        to a graph structure.
                        The graph structure is a network of nodes and edges, and the Racetrack Economy Model is
                        applied to
                        each node.
                        The nodes are connected by edges, and the transportation cost between nodes is determined by
                        the
                        distance between the nodes.
                    </p>
                    <ul>
                        <li>You can drag the canvas to translate, and pinch it to change its scale.</li>
                        <li>You can edit the graph structure with adding, removing and moving the nodes and edges on the
                            canvas,
                            with clicking the nodes and pressing the control-buttons on the right edge of the canvas.
                        </li>
                        <li>The graph structure is automatically layout by the spring layout algorithm.</li>
                    </ul>
                </div>
            </div>
            <div>
                <fast-button appearance="primary" id="infoDialogCloseButton">
                    OK
                </fast-button>
            </div>
        </div>
    </fast-dialog>


    <div class="version">
        <a aria-label="View source on GitHub" class="github-corner"
           href="https://github.com/kubohiroya/racetrack-economy-model">
            <svg aria-hidden="true" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;height:80px; width:80px"
                 viewBox="0 0 250 250"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
                <path class="octo-arm"
                      d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
                      fill="currentColor" style="transform-origin: 130px 106px;"></path>
                <path class="octo-body"
                      d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
                      fill="currentColor"></path>
            </svg>
        </a>
        <style>.github-corner:hover .octo-arm {
            animation: octocat-wave 560ms ease-in-out
        }

        @keyframes octocat-wave {
            0%, 100% {
                transform: rotate(0)
            }
            20%, 60% {
                transform: rotate(-25deg)
            }
            40%, 80% {
                transform: rotate(10deg)
            }
        }

        @media (max-width: 500px) {
            .github-corner:hover .octo-arm {
                animation: none
            }

            .github-corner .octo-arm {
                animation: octocat-wave 560ms ease-in-out
            }
        }</style>
    </div>

    <div id="canvasDivContainer">

        <div id="canvasDiv">

            <div id="raceTrack" style="display: block">
                <canvas
                        id="raceTrackCanvas"
                ></canvas>
            </div>

            <div id="graphCountry" style="display: block">
                <div style="position: relative;">

                    <button class="button" id="fitButton"
                            style="position: absolute; top: 10px; left: 5px; width: 42px; height: 42px; margin: 0; padding: 0"
                            title="Fit graph to canvas">
                        <div class="icon48" id="fitButtonIcon"></div>
                    </button>

                    <button class="button" id="addNodeButton"
                            style="position: absolute; top: 60px; left: 5px; width: 42px; height: 42px; margin: 0; padding: 0"
                            title="Add a node">
                        <div class="icon48" id="addNodeButtonIcon"></div>
                    </button>

                    <button class="button" id="removeNodeButton"
                            style="position: absolute; top: 110px; left: 5px; width: 42px; height: 42px; margin: 0; padding: 0"
                            title="Remove selected node(s)">
                        <div class="icon48" id="removeNodeButtonIcon"></div>
                    </button>

                    <button class="button" id="addEdgeButton"
                            style="position: absolute; top: 160px; left: 5px; width: 42px; height: 42px; margin: 0; padding: 0"
                            title="Add edge(s) between selected nodes">
                        <div class="icon48" id="addEdgeButtonIcon"></div>
                    </button>

                    <button class="button" id="removeEdgeButton"
                            style="position: absolute; top: 210px; left: 5px; width: 42px; height: 42px; margin: 0; padding: 0"
                            title="Remove edge(s) between selected nodes">
                        <div class="icon48" id="removeEdgeButtonIcon"></div>
                    </button>

                    <button id="importButton"
                            style="position: absolute; width: 42px; height: 42px; bottom: 68px; left: 5px; margin: 0; padding: 0"
                            title="Import graph structure data from local file">
                        <div class="icon48" id="fileUploadIcon"></div>
                    </button>

                    <button class="button" id="exportButton"
                            style="position: absolute; width: 42px; height: 42px; bottom: 18px; left: 5px; margin: 0; padding: 0"
                            title="Export graph structure data to local file">
                        <div class="icon48" id="fileDownloadIcon"></div>
                    </button>

                    <canvas class="disable-scroll" id="graphCanvas">
                    </canvas>

                </div>

            </div>

            <div id="visualizerTypeSelector">
                <span>
                Share of Manufacturing:
                </span>
                <select id="mshareVisualizer">
                    <option value="">--</option>
                    <optgroup label="circle on circumference">
                        <option value="radius">radius</option>
                        <option value="color">color</option>
                    </optgroup>
                    <optgroup label="polygon">
                        <option value="dot">dot</option>
                        <option value="red">red</option>
                        <option value="gray">gray</option>
                    </optgroup>
                </select>

                &gt;
                <span id="priceIndexLabel">PriceIndex:</span>
                <select id="priceIndexVisualizer">
                    <option value="">--</option>
                    <optgroup label="circle on circumference">
                        <option value="radius">radius</option>
                        <option value="color">color</option>
                    </optgroup>
                    <optgroup label="polygon">
                        <option value="dot">dot</option>
                        <option value="red">red</option>
                        <option value="gray">gray</option>
                    </optgroup>
                </select>
                &gt;
                <span id="nominalWageLabel">NominalWage: </span>
                <select id="nominalWageVisualizer">
                    <option value="">--</option>
                    <optgroup label="circle on circumference">
                        <option value="radius">radius</option>
                        <option value="color">color</option>
                    </optgroup>
                    <optgroup label="polygon">
                        <option value="dot">dot</option>
                        <option value="red">red</option>
                        <option value="gray">gray</option>
                    </optgroup>
                </select>
                &gt;
                <span id="realWageLabel">RealWage: </span>
                <select id="realWageVisualizer">
                    <option value="">--</option>
                    <optgroup label="circle on circumference">
                        <option value="radius">radius</option>
                        <option value="color">color</option>
                    </optgroup>
                    <optgroup label="polygon">
                        <option value="dot">dot</option>
                        <option value="red">red</option>
                        <option value="gray">gray</option>
                    </optgroup>
                </select>
                &gt;
                <span id="avgRealWageLabel">AverageRealWage: </span>
                <select id="avgRealWageVisualizer">
                    <option value="">--</option>
                    <optgroup label="circle on circumference">
                        <option value="radius">radius</option>
                        <option value="color">color</option>
                    </optgroup>
                    <optgroup label="polygon">
                        <option value="dot">dot</option>
                        <option value="red">red</option>
                        <option value="gray">gray</option>
                    </optgroup>
                </select>
            </div>

        </div>

        <div id="barChart" style="position: relative">

            <canvas
                    height="300"
                    id="barChartCanvas" width="700"
            >
            </canvas>

            <div id="scaleSelector"
                 style="position: absolute; top: 10px; right: 10px; z-index: 100"
            >
                <div class="icon" id="magnifyIcon"></div>
                <select id="scale">
                    <option>x 21</option>
                    <option>x 13</option>
                    <option>x 8</option>
                    <option>x 5</option>
                    <option>x 3</option>
                    <option>x 2</option>
                    <option selected>x 1</option>
                </select>
            </div>

            <div id="barChartCaption">
                <div class="caption">
                    <select id="barChartSelector">
                        <option>Share of Manufacturing</option>
                        <option>Price Index</option>
                        <option>Nominal Wage</option>
                        <option>Real Wage</option>
                    </select>
                </div>
            </div>

        </div>

    </div>

</div>

<div style="display: flex">
    <div style="flex:1">
        <fast-radio-group id="caseSelector" name="case" value="0">
            <fast-radio value="0">
                <p class="preset">Base case: (K=12, π=0.2, τ=2, σ=4). All workers usually end up in two
                    concentrations.</p>
            </fast-radio>
            <fast-radio value="1">
                <p class="preset">Case i: Less differentiated products (K=12, π=0.2, τ=2, σ=2). In this case (in
                    which
                    firms have more market power, and in which the equilibrium degree of scale economies is also
                    larger),
                    all runs produced only a single city.</p>
            </fast-radio>
            <fast-radio value="2">
                <p class="preset">Case ii: A larger manufacturing share (K=12, π=0.4, τ=2, σ=4). In this case, in
                    which one
                    would expect the backward and forward linkages driving agglomeration to be stronger, we also
                    consistently get only a single city.</p>
            </fast-radio>
            <fast-radio value="3">
                <p class="preset">Case iii: Lower transport costs (K=12, π=0.2, τ=1, σ=4). In this case we would
                    expect
                    there to be less incentive to set up multiple urban centers, and again all ten runs produce only
                    a
                    single city.</p>
            </fast-radio>
        </fast-radio-group>
    </div>

    <div style="flex:1">
        <div class="slider-container">
            <div class="slider-label" id="K-label">
                <div class="icon" id="cityIcon"></div>
                <span class="slider-label">K = </span><span id="numRegions"></span>
            </div>
            <fast-tooltip anchor="K-label" position="top">
                K: The number of regions connected by transportation network.
            </fast-tooltip>

            <fast-slider
                    id="numRegionsSlider"
                    max="100" min="0"
                    step="1"
                    value="12">
                <fast-slider-label position="0">0</fast-slider-label>
                <fast-slider-label position="20">20</fast-slider-label>
                <fast-slider-label position="40">40</fast-slider-label>
                <fast-slider-label position="60">60</fast-slider-label>
                <fast-slider-label position="80">80</fast-slider-label>
                <fast-slider-label position="100">100</fast-slider-label>
            </fast-slider>
        </div>

        <div class="slider-container">
            <div class="slider-label" id="pi-label">
                <div class="icon" id="factoryIcon"></div>
                <span class="slider-label">π = </span><span id="pi"></span>
            </div>
            <fast-tooltip anchor="pi-label" position="top">
                π: The share of manufacturing goods in expenditure.
            </fast-tooltip>

            <fast-slider
                    id="piSlider"
                    max="1.0" min="0" step="0.01"
                    value="0.2">
                <fast-slider-label position="0">0</fast-slider-label>
                <fast-slider-label position="0.2">0.2</fast-slider-label>
                <fast-slider-label position="0.4">0.4</fast-slider-label>
                <fast-slider-label position="0.6">0.6</fast-slider-label>
                <fast-slider-label position="0.8">0.8</fast-slider-label>
                <fast-slider-label position="1.0">1.0</fast-slider-label>
            </fast-slider>
        </div>

        <div class="slider-container">
            <div class="slider-label" id="tcost-label">
                <div class="icon" id="truckIcon"></div>
                <span class="slider-label">τ = </span><span id="tcost"></span>
            </div>
            <fast-tooltip anchor="tcost-label" position="top">
                τ: The level of transportation cost among locations. A value of 1 represents no transportation cost,
                while a value of 10 represents significant transportation cost.
            </fast-tooltip>
            <fast-slider
                    id="tcostSlider"
                    max="10" min="1" step="0.1"
                    value="2">
                <fast-slider-label position="1">1</fast-slider-label>
                <fast-slider-label position="4">4</fast-slider-label>
                <fast-slider-label position="7">7</fast-slider-label>
                <fast-slider-label position="10">10</fast-slider-label>
            </fast-slider>
        </div>

        <div class="slider-container">
            <div class="slider-label" id="sigma-label">
                <div class="icon" id="headHeartIcon"></div>
                <span class="slider-label">σ = </span><span id="sigma"></span>
            </div>
            <fast-tooltip anchor="sigma-label" position="top">
                σ: The elasticity of substitution among manufactured goods. A value of 1 represents a strong love of
                variety, while a value of 20 represents a limited love of variety.
            </fast-tooltip>
            <fast-slider
                    id="sigmaSlider"
                    max="20" min="1" step="0.1"
                    value="4">
                <fast-slider-label position="1">1</fast-slider-label>
                <fast-slider-label position="5">5</fast-slider-label>
                <fast-slider-label position="10">10</fast-slider-label>
                <fast-slider-label position="15">15</fast-slider-label>
                <fast-slider-label position="20">20</fast-slider-label>
            </fast-slider>
        </div>
    </div>
</div>

<div style="display:flex">
    <div class="blink"
         id="buttonPanel"
         style="flex: 1"
    >
        <fast-button
                class="command"
                id="start"
        >
            <div class="iconButton">
                <div class="icon" id="startIcon"></div>
                <div>Start</div>
            </div>
        </fast-button>

        <fast-button
                class="command"
                id="stop"
        >
            <div class="iconButton">
                <div class="icon" id="stopIcon"></div>
                <div>Stop</div>
            </div>
        </fast-button>

        <fast-button
                class="command"
                id="reset"
        >
            <div class="iconButton">
                <div class="icon" id="resetIcon"></div>
                <div>Reset</div>
            </div>
        </fast-button>

        <div id="counterDiv">
            Time: <span id="counter">0</span>
        </div>
    </div>
    <div style="flex:1; margin-top: 10px; margin-right: 50px">
        <fast-slider
                id="speedSlider"
                max="1.0" min="0" step="0.05"
                value="0.5">
            <fast-slider-label position="0" style="left: 32px">🐢 slow</fast-slider-label>
            <fast-slider-label position="1" style="margin-left: 24px">🐇 fast</fast-slider-label>
        </fast-slider>
    </div>
</div>
<!--
    <ul>
        <li>K: The number of locations assumed to be laid out symmetrically in a circle, with transportation
            possible only around the circumference. The distance between any two neighboring locations is set equal
            to one.
        </li>
        <li>π: The share of manufacturing goods in expenditure.</li>
        <li>τ: The level of transportation cost among locations. A value of 1 represents no transportation cost,
            while a value of 10 represents significant transportation cost.
        </li>
        <li>σ: The elasticity of substitution among manufactured goods. A value of 1 represents a strong love of
            variety, while a value of 20 represents a limited love of variety.
        </li>
    </ul>
-->
<div style="display: flex; gap: 20px">
    <div>
        <h3 style="display: flex">
            <div class="icon" id="adjacencyMatrixIcon"></div>
            Adjacency distances between each pair of locations
        </h3>
        <table id="adjacencyMatrix">
        </table>
    </div>
    <div>
        <h3 style="display: flex">
            <div class="icon" id="distanceMatrixIcon"></div>
            Distances between each pair of locations
        </h3>
        <table id="distanceMatrix">
        </table>
    </div>
    <div>
        <h3 style="display: flex">
            <div class="icon" id="transportCostMatrixIcon"></div>
            Transportation costs between each pair of locations
        </h3>
        <table id="transportCostMatrix">
        </table>
    </div>
</div>

<h3>References</h3>
<ul>
    <li>Krugman, P. (1993) On the number and location of cities. <i>European Economic Review</i>, Vol. 37 (2-3)
        pp.293-298.
    </li>
    <li>Fujita, M., Krugman, P., Venables, A. (1999) "The Spatial Economy: Cities, Regions, and International
        Trade", <i>MIT Press</i>.
    </li>
</ul>
</div>

<script src="src/index.ts" type="module"></script>
</body>
</html>
